"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parse = void 0;
var minimist = require("minimist");
var errors_1 = require("./errors");
var tempfile = require("tempfile");
/**
 * Grabs the platform or dies horribly.
 *
 * @param parsed The minimist parsed arguments.
 */
function getPlatform(parsed) {
    var platform = parsed._[0];
    // no platform?
    if (!platform)
        throw (0, errors_1.createError)(errors_1.ErrorCode.MissingPlatform);
    // bad platform?
    if (platform !== 'ios' && platform !== 'android') {
        throw (0, errors_1.createError)(errors_1.ErrorCode.InvalidPlatform);
    }
    return platform;
}
/**
 * Parses and validates the CLI parameter.
 *
 * @param argv The parameters to use (default: reads from `process.argv`)
 */
function parse(argv) {
    // use the default process args if nothing was passed in
    argv = argv || process.argv.slice(2);
    // parse the arguments with minimist
    var parsed = minimist(argv);
    // grab what we need
    var platform = getPlatform(parsed);
    var useClipboard = !parsed['f'];
    var filename = parsed['f'] || tempfile('.png');
    var device = parsed['d'];
    return { platform: platform, filename: filename, device: device, useClipboard: useClipboard };
}
exports.parse = parse;
