{"version":3,"names":["ObjectInspectorItem","props","ast","expandLevel","depth","resolved","setResolved","useState","open","setOpen","Boolean","useEffect","resolve","type","promises","children","map","f","Promise","all","r","onSelect","value","child","key","defaultProps"],"sources":["ObjectInspectorItem.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Tree } from \"@devtools-ds/tree\";\nimport { ResolvedASTNode, ASTNode } from \"@devtools-ds/object-parser\";\nimport ObjectValue from \"./ObjectValue\";\nimport ObjectLabel from \"./ObjectLabel\";\n\ninterface ObjectInspectorItemProps {\n  /** JSON ast to render in the tree. */\n  ast: ASTNode;\n  /** The current depth. */\n  depth: number;\n  /** Depth of the tree that is open at first render. */\n  expandLevel: number;\n  /** Callback when a particular node in the tree is actively selected */\n  onSelect?: (node?: ASTNode | ResolvedASTNode) => void;\n}\n\n/** A simple component. */\nexport const ObjectInspectorItem = (props: ObjectInspectorItemProps) => {\n  const { ast, expandLevel, depth } = props;\n\n  const [resolved, setResolved] = useState<ResolvedASTNode | undefined>();\n  const [open, setOpen] = useState(Boolean(depth < expandLevel));\n\n  /** Handle async children */\n  useEffect(() => {\n    /** Async function to resolve children */\n    const resolve = async () => {\n      if (ast.type !== \"value\") {\n        const promises = ast.children.map((f) => f());\n        const children = await Promise.all(promises);\n        const r = {\n          ...ast,\n          children,\n        };\n        setResolved(r);\n      }\n    };\n\n    resolve();\n  }, [ast]);\n\n  if (resolved) {\n    return (\n      <Tree\n        hover={false}\n        open={open}\n        label={<ObjectLabel open={open} ast={resolved} />}\n        onSelect={() => {\n          props.onSelect?.(ast);\n        }}\n        onUpdate={(value: boolean) => {\n          setOpen(value);\n        }}\n      >\n        {resolved.children.map((child) => {\n          return (\n            <ObjectInspectorItem\n              key={child.key}\n              ast={child}\n              depth={depth + 1}\n              expandLevel={expandLevel}\n              onSelect={props.onSelect}\n            />\n          );\n        })}\n      </Tree>\n    );\n  }\n\n  return (\n    <Tree\n      hover={false}\n      label={<ObjectValue ast={ast} />}\n      onSelect={() => {\n        props.onSelect?.(ast);\n      }}\n    />\n  );\n};\n\nObjectInspectorItem.defaultProps = {\n  expandLevel: 0,\n  depth: 0,\n};\n\nexport default ObjectInspectorItem;\n"],"mappings":";;;;;;;;AAAA;AACA;AAEA;AACA;AAAwC;AAAA;AAaxC;AACO,MAAMA,mBAAmB,GAAIC,KAA+B,IAAK;EACtE,MAAM;IAAEC,GAAG;IAAEC,WAAW;IAAEC;EAAM,CAAC,GAAGH,KAAK;EAEzC,MAAM,CAACI,QAAQ,EAAEC,WAAW,CAAC,GAAG,IAAAC,eAAQ,GAA+B;EACvE,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAG,IAAAF,eAAQ,EAACG,OAAO,CAACN,KAAK,GAAGD,WAAW,CAAC,CAAC;;EAE9D;EACA,IAAAQ,gBAAS,EAAC,MAAM;IACd;IACA,MAAMC,OAAO,GAAG,YAAY;MAC1B,IAAIV,GAAG,CAACW,IAAI,KAAK,OAAO,EAAE;QACxB,MAAMC,QAAQ,GAAGZ,GAAG,CAACa,QAAQ,CAACC,GAAG,CAAEC,CAAC,IAAKA,CAAC,EAAE,CAAC;QAC7C,MAAMF,QAAQ,GAAG,MAAMG,OAAO,CAACC,GAAG,CAACL,QAAQ,CAAC;QAC5C,MAAMM,CAAC,+DACFlB,GAAG;UACNa;QAAQ,EACT;QACDT,WAAW,CAACc,CAAC,CAAC;MAChB;IACF,CAAC;IAEDR,OAAO,EAAE;EACX,CAAC,EAAE,CAACV,GAAG,CAAC,CAAC;EAET,IAAIG,QAAQ,EAAE;IACZ,oBACE,6BAAC,UAAI;MACH,KAAK,EAAE,KAAM;MACb,IAAI,EAAEG,IAAK;MACX,KAAK,eAAE,6BAAC,oBAAW;QAAC,IAAI,EAAEA,IAAK;QAAC,GAAG,EAAEH;MAAS,EAAI;MAClD,QAAQ,EAAE,MAAM;QAAA;QACd,mBAAAJ,KAAK,CAACoB,QAAQ,oDAAd,qBAAApB,KAAK,EAAYC,GAAG,CAAC;MACvB,CAAE;MACF,QAAQ,EAAGoB,KAAc,IAAK;QAC5Bb,OAAO,CAACa,KAAK,CAAC;MAChB;IAAE,GAEDjB,QAAQ,CAACU,QAAQ,CAACC,GAAG,CAAEO,KAAK,IAAK;MAChC,oBACE,6BAAC,mBAAmB;QAClB,GAAG,EAAEA,KAAK,CAACC,GAAI;QACf,GAAG,EAAED,KAAM;QACX,KAAK,EAAEnB,KAAK,GAAG,CAAE;QACjB,WAAW,EAAED,WAAY;QACzB,QAAQ,EAAEF,KAAK,CAACoB;MAAS,EACzB;IAEN,CAAC,CAAC,CACG;EAEX;EAEA,oBACE,6BAAC,UAAI;IACH,KAAK,EAAE,KAAM;IACb,KAAK,eAAE,6BAAC,oBAAW;MAAC,GAAG,EAAEnB;IAAI,EAAI;IACjC,QAAQ,EAAE,MAAM;MAAA;MACd,oBAAAD,KAAK,CAACoB,QAAQ,qDAAd,sBAAApB,KAAK,EAAYC,GAAG,CAAC;IACvB;EAAE,EACF;AAEN,CAAC;AAAC;AAEFF,mBAAmB,CAACyB,YAAY,GAAG;EACjCtB,WAAW,EAAE,CAAC;EACdC,KAAK,EAAE;AACT,CAAC;AAAC,eAEaJ,mBAAmB;AAAA"}
