const React = require('react');
const importJsx = require('import-jsx');
const {
  EVENT_CHANGE,
  EVENT_END
} = require('../../task-runner');
const TaskList = importJsx('./TaskList');
const throttle = (fn, threshold = 16) => {
  let throttled = false;
  let lastCalledArguments = null;
  const executeAfterThreshold = () => setTimeout(() => {
    if (lastCalledArguments) {
      fn(...lastCalledArguments);
      lastCalledArguments = null;
      executeAfterThreshold();
    } else {
      throttled = false;
    }
  }, threshold);
  return (...args) => {
    if (throttled) {
      lastCalledArguments = args;
    } else {
      throttled = true;
      executeAfterThreshold();
      fn(...args);
    }
  };
};
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      tasks: this.props.taskRunner.getState()
    };
    this.ended = false;
    const updateTasks = () => {
      if (!this.ended) {
        const tasks = this.props.taskRunner.getState();
        this.setState({
          tasks
        });
      }
    };
    this.handleEnd = () => {
      updateTasks();
      this.ended = true;
    };
    this.handleChange = throttle(updateTasks, 200);
  }
  componentDidMount() {
    this.props.taskRunner.on(EVENT_END, this.handleEnd);
    this.props.taskRunner.on(EVENT_CHANGE, this.handleChange);
  }
  componentWillUnmount() {
    this.ended = true;
    this.props.taskRunner.removeListener(EVENT_END, this.handleEnd);
    this.props.taskRunner.removeListener(EVENT_CHANGE, this.handleChange);
  }
  render() {
    return /*#__PURE__*/React.createElement(TaskList, {
      tasks: this.state.tasks
    });
  }
}
module.exports = App;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdCIsInJlcXVpcmUiLCJpbXBvcnRKc3giLCJFVkVOVF9DSEFOR0UiLCJFVkVOVF9FTkQiLCJUYXNrTGlzdCIsInRocm90dGxlIiwiZm4iLCJ0aHJlc2hvbGQiLCJ0aHJvdHRsZWQiLCJsYXN0Q2FsbGVkQXJndW1lbnRzIiwiZXhlY3V0ZUFmdGVyVGhyZXNob2xkIiwic2V0VGltZW91dCIsImFyZ3MiLCJBcHAiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwic3RhdGUiLCJ0YXNrcyIsInRhc2tSdW5uZXIiLCJnZXRTdGF0ZSIsImVuZGVkIiwidXBkYXRlVGFza3MiLCJzZXRTdGF0ZSIsImhhbmRsZUVuZCIsImhhbmRsZUNoYW5nZSIsImNvbXBvbmVudERpZE1vdW50Iiwib24iLCJjb21wb25lbnRXaWxsVW5tb3VudCIsInJlbW92ZUxpc3RlbmVyIiwicmVuZGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkFwcC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG5jb25zdCBpbXBvcnRKc3ggPSByZXF1aXJlKCdpbXBvcnQtanN4Jyk7XG5jb25zdCB7IEVWRU5UX0NIQU5HRSwgRVZFTlRfRU5EIH0gPSByZXF1aXJlKCcuLi8uLi90YXNrLXJ1bm5lcicpO1xuXG5jb25zdCBUYXNrTGlzdCA9IGltcG9ydEpzeCgnLi9UYXNrTGlzdCcpO1xuXG5jb25zdCB0aHJvdHRsZSA9IChmbiwgdGhyZXNob2xkID0gMTYpID0+IHtcbiAgbGV0IHRocm90dGxlZCA9IGZhbHNlO1xuICBsZXQgbGFzdENhbGxlZEFyZ3VtZW50cyA9IG51bGw7XG5cbiAgY29uc3QgZXhlY3V0ZUFmdGVyVGhyZXNob2xkID0gKCkgPT5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmIChsYXN0Q2FsbGVkQXJndW1lbnRzKSB7XG4gICAgICAgIGZuKC4uLmxhc3RDYWxsZWRBcmd1bWVudHMpO1xuICAgICAgICBsYXN0Q2FsbGVkQXJndW1lbnRzID0gbnVsbDtcbiAgICAgICAgZXhlY3V0ZUFmdGVyVGhyZXNob2xkKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdHRsZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LCB0aHJlc2hvbGQpO1xuXG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIGlmICh0aHJvdHRsZWQpIHtcbiAgICAgIGxhc3RDYWxsZWRBcmd1bWVudHMgPSBhcmdzO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdHRsZWQgPSB0cnVlO1xuICAgICAgZXhlY3V0ZUFmdGVyVGhyZXNob2xkKCk7XG4gICAgICBmbiguLi5hcmdzKTtcbiAgICB9XG4gIH07XG59O1xuXG5jbGFzcyBBcHAgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICB0YXNrczogdGhpcy5wcm9wcy50YXNrUnVubmVyLmdldFN0YXRlKCksXG4gICAgfTtcblxuICAgIHRoaXMuZW5kZWQgPSBmYWxzZTtcblxuICAgIGNvbnN0IHVwZGF0ZVRhc2tzID0gKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmVuZGVkKSB7XG4gICAgICAgIGNvbnN0IHRhc2tzID0gdGhpcy5wcm9wcy50YXNrUnVubmVyLmdldFN0YXRlKCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0YXNrcyB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5oYW5kbGVFbmQgPSAoKSA9PiB7XG4gICAgICB1cGRhdGVUYXNrcygpO1xuICAgICAgdGhpcy5lbmRlZCA9IHRydWU7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZUNoYW5nZSA9IHRocm90dGxlKHVwZGF0ZVRhc2tzLCAyMDApO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5wcm9wcy50YXNrUnVubmVyLm9uKEVWRU5UX0VORCwgdGhpcy5oYW5kbGVFbmQpO1xuICAgIHRoaXMucHJvcHMudGFza1J1bm5lci5vbihFVkVOVF9DSEFOR0UsIHRoaXMuaGFuZGxlQ2hhbmdlKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHRoaXMuZW5kZWQgPSB0cnVlO1xuICAgIHRoaXMucHJvcHMudGFza1J1bm5lci5yZW1vdmVMaXN0ZW5lcihFVkVOVF9FTkQsIHRoaXMuaGFuZGxlRW5kKTtcbiAgICB0aGlzLnByb3BzLnRhc2tSdW5uZXIucmVtb3ZlTGlzdGVuZXIoRVZFTlRfQ0hBTkdFLCB0aGlzLmhhbmRsZUNoYW5nZSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIDxUYXNrTGlzdCB0YXNrcz17dGhpcy5zdGF0ZS50YXNrc30gLz47XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBcHA7XG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQU8sQ0FBQztBQUM5QixNQUFNQyxTQUFTLEdBQUdELE9BQU8sQ0FBQyxZQUFZLENBQUM7QUFDdkMsTUFBTTtFQUFFRSxZQUFZO0VBQUVDO0FBQVUsQ0FBQyxHQUFHSCxPQUFPLENBQUMsbUJBQW1CLENBQUM7QUFFaEUsTUFBTUksUUFBUSxHQUFHSCxTQUFTLENBQUMsWUFBWSxDQUFDO0FBRXhDLE1BQU1JLFFBQVEsR0FBRyxDQUFDQyxFQUFFLEVBQUVDLFNBQVMsR0FBRyxFQUFFLEtBQUs7RUFDdkMsSUFBSUMsU0FBUyxHQUFHLEtBQUs7RUFDckIsSUFBSUMsbUJBQW1CLEdBQUcsSUFBSTtFQUU5QixNQUFNQyxxQkFBcUIsR0FBRyxNQUM1QkMsVUFBVSxDQUFDLE1BQU07SUFDZixJQUFJRixtQkFBbUIsRUFBRTtNQUN2QkgsRUFBRSxDQUFDLEdBQUdHLG1CQUFtQixDQUFDO01BQzFCQSxtQkFBbUIsR0FBRyxJQUFJO01BQzFCQyxxQkFBcUIsRUFBRTtJQUN6QixDQUFDLE1BQU07TUFDTEYsU0FBUyxHQUFHLEtBQUs7SUFDbkI7RUFDRixDQUFDLEVBQUVELFNBQVMsQ0FBQztFQUVmLE9BQU8sQ0FBQyxHQUFHSyxJQUFJLEtBQUs7SUFDbEIsSUFBSUosU0FBUyxFQUFFO01BQ2JDLG1CQUFtQixHQUFHRyxJQUFJO0lBQzVCLENBQUMsTUFBTTtNQUNMSixTQUFTLEdBQUcsSUFBSTtNQUNoQkUscUJBQXFCLEVBQUU7TUFDdkJKLEVBQUUsQ0FBQyxHQUFHTSxJQUFJLENBQUM7SUFDYjtFQUNGLENBQUM7QUFDSCxDQUFDO0FBRUQsTUFBTUMsR0FBRyxTQUFTZCxLQUFLLENBQUNlLFNBQVMsQ0FBQztFQUNoQ0MsV0FBVyxDQUFDQyxLQUFLLEVBQUU7SUFDakIsS0FBSyxDQUFDQSxLQUFLLENBQUM7SUFFWixJQUFJLENBQUNDLEtBQUssR0FBRztNQUNYQyxLQUFLLEVBQUUsSUFBSSxDQUFDRixLQUFLLENBQUNHLFVBQVUsQ0FBQ0MsUUFBUTtJQUN2QyxDQUFDO0lBRUQsSUFBSSxDQUFDQyxLQUFLLEdBQUcsS0FBSztJQUVsQixNQUFNQyxXQUFXLEdBQUcsTUFBTTtNQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDRCxLQUFLLEVBQUU7UUFDZixNQUFNSCxLQUFLLEdBQUcsSUFBSSxDQUFDRixLQUFLLENBQUNHLFVBQVUsQ0FBQ0MsUUFBUSxFQUFFO1FBQzlDLElBQUksQ0FBQ0csUUFBUSxDQUFDO1VBQUVMO1FBQU0sQ0FBQyxDQUFDO01BQzFCO0lBQ0YsQ0FBQztJQUVELElBQUksQ0FBQ00sU0FBUyxHQUFHLE1BQU07TUFDckJGLFdBQVcsRUFBRTtNQUNiLElBQUksQ0FBQ0QsS0FBSyxHQUFHLElBQUk7SUFDbkIsQ0FBQztJQUNELElBQUksQ0FBQ0ksWUFBWSxHQUFHcEIsUUFBUSxDQUFDaUIsV0FBVyxFQUFFLEdBQUcsQ0FBQztFQUNoRDtFQUVBSSxpQkFBaUIsR0FBRztJQUNsQixJQUFJLENBQUNWLEtBQUssQ0FBQ0csVUFBVSxDQUFDUSxFQUFFLENBQUN4QixTQUFTLEVBQUUsSUFBSSxDQUFDcUIsU0FBUyxDQUFDO0lBQ25ELElBQUksQ0FBQ1IsS0FBSyxDQUFDRyxVQUFVLENBQUNRLEVBQUUsQ0FBQ3pCLFlBQVksRUFBRSxJQUFJLENBQUN1QixZQUFZLENBQUM7RUFDM0Q7RUFFQUcsb0JBQW9CLEdBQUc7SUFDckIsSUFBSSxDQUFDUCxLQUFLLEdBQUcsSUFBSTtJQUNqQixJQUFJLENBQUNMLEtBQUssQ0FBQ0csVUFBVSxDQUFDVSxjQUFjLENBQUMxQixTQUFTLEVBQUUsSUFBSSxDQUFDcUIsU0FBUyxDQUFDO0lBQy9ELElBQUksQ0FBQ1IsS0FBSyxDQUFDRyxVQUFVLENBQUNVLGNBQWMsQ0FBQzNCLFlBQVksRUFBRSxJQUFJLENBQUN1QixZQUFZLENBQUM7RUFDdkU7RUFFQUssTUFBTSxHQUFHO0lBQ1Asb0JBQU8sb0JBQUMsUUFBUTtNQUFDLEtBQUssRUFBRSxJQUFJLENBQUNiLEtBQUssQ0FBQ0M7SUFBTSxFQUFHO0VBQzlDO0FBQ0Y7QUFFQWEsTUFBTSxDQUFDQyxPQUFPLEdBQUduQixHQUFHIn0=